<!DOCTYPE html><html lang="es"><head><meta charset="UTF-8"><title>Test Carga Google Sheets</title><style>body{font-family:system-ui;max-width:800px;margin:40px auto;padding:20px}h1{color:#8a0bd2}.status{padding:10px;margin:10px 0;border-radius:8px}.success{background:#d4edda;color:#155724}.error{background:#f8d7da;color:#721c24}.info{background:#d1ecf1;color:#0c5460}pre{background:#f5f5f5;padding:10px;border-radius:4px;overflow-x:auto}button{background:#8a0bd2;color:#fff;border:none;padding:10px 20px;border-radius:8px;cursor:pointer;margin:5px}button:hover{opacity:.9}</style></head><body><h1>üîç Test de Carga de Agenda desde Google Sheets</h1><div id="status"></div><h2>URL Configurada:</h2><pre id="url"></pre><button onclick="testFetch()">üîÑ Probar Carga</button> <button onclick="location.reload()">üîÉ Recargar P√°gina</button><h2>Resultado:</h2><div id="result"></div><h2>Eventos Parseados:</h2><div id="eventos"></div><h2>Instrucciones para Actualizar la Hoja:</h2><ol><li><strong>Abr√≠ tu Google Sheet</strong> con los eventos</li><li>Ve a <strong>Archivo ‚Üí Compartir ‚Üí Publicar en la web</strong></li><li>Seleccion√° la hoja espec√≠fica (ej: "Hoja 1" o "Agenda")</li><li>En formato, eleg√≠: <strong>Valores separados por comas (.csv)</strong></li><li>Copi√° el enlace p√∫blico (debe terminar en <code>output=csv</code>)</li><li>Pegalo en <code>js/agenda-loader.js</code> l√≠nea 14</li><li><strong>Importante:</strong> Limpi√° la cach√© del navegador (Ctrl+Shift+Delete) despu√©s de actualizar</li></ol><h3>Formato esperado del CSV:</h3><pre>fecha,hora,titulo,subtitulo,cupos,estado,link_reservar,link_consultar,imagen
S√°b 16 Nov,18:00,Vinito y Tarot,Microcentro,6,Quedan 6,,,
Vie 29 Nov,19:00,Vinito y Tarot a domicilio,,10-30,Cupos 10‚Äì30,,,</pre><script src="./js/agenda-loader.js"></script><script>const SHEET_URL="https://docs.google.com/spreadsheets/d/e/2PACX-1vSNJARxZ_CBiwnjGUDOonIqTqRp8xjrtfhltQRp-ptEbcga2Qxb9Apg2ecALLLM8g/pub?gid=396204798&single=true&output=csv";function showStatus(e,t){const n=document.getElementById("status");n.className="status "+t,n.innerHTML=e}function testFetch(){showStatus("‚è≥ Cargando desde Google Sheets...","info"),document.getElementById("result").innerHTML="",document.getElementById("eventos").innerHTML="",fetch(SHEET_URL,{cache:"no-store"}).then(e=>{if(!e.ok)throw new Error(`HTTP ${e.status}: ${e.statusText}`);return showStatus(`‚úÖ Conexi√≥n exitosa (HTTP ${e.status})`,"success"),e.text()}).then(e=>{document.getElementById("result").innerHTML="<strong>CSV recibido:</strong><pre>"+e.substring(0,1e3)+(e.length>1e3?"\n\n... (truncado)":"")+"</pre>";const t=e.trim().split(/\r?\n/),n=t[0].split(",").map(e=>e.trim()),s=t.slice(1).map(e=>{const t=[];let s="",o=!1;for(let n=0;n<e.length;n++){const l=e[n];'"'!==l||'"'!==e[n+1]?'"'!==l?","!==l||o?s+=l:(t.push(s),s=""):o=!o:(s+='"',n++)}t.push(s);const l={};return n.forEach((e,n)=>l[e]=(t[n]||"").trim()),l}).filter(e=>""!==(e.titulo||"").trim());if(s.length>0){showStatus(`‚úÖ ${s.length} evento(s) encontrado(s)`,"success");let e='<table border="1" cellpadding="8" style="border-collapse: collapse; width: 100%;">';e+="<tr><th>Fecha</th><th>Hora</th><th>T√≠tulo</th><th>Cupos</th></tr>",s.forEach(t=>{e+=`<tr>\n                <td>${t.fecha||"-"}</td>\n                <td>${t.hora||"-"}</td>\n                <td>${t.titulo||"-"}${t.subtitulo?" ‚Äì "+t.subtitulo:""}</td>\n                <td>${t.estado||t.cupos||"-"}</td>\n              </tr>`}),e+="</table>",document.getElementById("eventos").innerHTML=e}else showStatus("‚ö†Ô∏è CSV v√°lido pero sin eventos (todas las filas vac√≠as)","error")}).catch(e=>{showStatus(`‚ùå Error: ${e.message}`,"error"),document.getElementById("result").innerHTML=`<pre style="color: red;">${e.stack||e}</pre>`;let t="<h3>Posibles causas:</h3><ul>";e.message.includes("403")||e.message.includes("404")?(t+="<li>La hoja no est√° publicada en la web</li>",t+="<li>El enlace no es correcto</li>",t+="<li>Verific√° que el enlace sea p√∫blico y termine en <code>output=csv</code></li>"):e.message.includes("CORS")?t+="<li>Problema de CORS (la hoja debe estar publicada p√∫blicamente)</li>":(t+="<li>Verific√° tu conexi√≥n a internet</li>",t+="<li>Intent√° abrir el enlace directamente en el navegador</li>"),t+="</ul>",document.getElementById("eventos").innerHTML=t})}document.getElementById("url").textContent=SHEET_URL,setTimeout(testFetch,500),window.AGENDA_LOADER_PROMISE&&window.AGENDA_LOADER_PROMISE.then(()=>{window.AGENDA_EVENTOS&&window.AGENDA_EVENTOS.length&&console.log("‚úÖ agenda-loader.js carg√≥ correctamente:",window.AGENDA_EVENTOS)})</script></body></html>