<!DOCTYPE html><html lang="es"><head><meta charset="UTF-8"><title>üéÆ Simulador de Cambios - Ser Magia</title><style>*{box-sizing:border-box}body{font-family:system-ui,-apple-system,sans-serif;max-width:1200px;margin:0 auto;padding:20px;background:linear-gradient(135deg,#8b5cf6 0,#ec4899 100%);color:#fff}h1{text-align:center;margin-bottom:30px}.container{display:grid;grid-template-columns:1fr 1fr;gap:20px}.panel{background:rgba(255,255,255,.15);backdrop-filter:blur(10px);border-radius:16px;padding:25px;box-shadow:0 8px 32px rgba(0,0,0,.2);border:1px solid rgba(255,255,255,.2)}h2{margin-top:0;color:#fbbf24;text-shadow:0 2px 4px rgba(0,0,0,.3)}.demo-controls{display:flex;flex-direction:column;gap:15px}.demo-controls button{background:rgba(139,92,246,.8);color:#fff;border:none;padding:15px 20px;border-radius:10px;cursor:pointer;font-weight:600;font-size:1em;transition:all .3s;text-align:left}.demo-controls button:hover{background:#8b5cf6;transform:translateY(-2px);box-shadow:0 4px 12px rgba(139,92,246,.5)}.demo-controls button:active{transform:translateY(0)}.status{padding:15px;border-radius:8px;margin:15px 0;font-weight:600;border-left:4px solid}.success{background:rgba(16,185,129,.3);border-color:#10b981}.info{background:rgba(59,130,246,.3);border-color:#3b82f6}.warning{background:rgba(245,158,11,.3);border-color:#f59e0b}.eventos-list{display:flex;flex-direction:column;gap:12px;max-height:400px;overflow-y:auto}.evento-card{background:rgba(255,255,255,.1);padding:15px;border-radius:10px;border:1px solid rgba(255,255,255,.2);transition:all .3s}.evento-card.updated{animation:highlight 1s ease;border-color:#10b981}@keyframes highlight{0%,100%{background:rgba(255,255,255,.1)}50%{background:rgba(16,185,129,.3)}}.timer{font-size:3em;font-weight:700;text-align:center;color:#fbbf24;text-shadow:0 2px 8px rgba(0,0,0,.3);margin:20px 0;font-family:'Courier New',monospace}.instructions{background:rgba(0,0,0,.2);padding:15px;border-radius:8px;margin-top:15px;font-size:.9em;line-height:1.6}@media (max-width:768px){.container{grid-template-columns:1fr}}</style></head><body><h1>üéÆ Simulador de Auto-Refresh en Tiempo Real</h1><div class="container"><div class="panel"><h2>üéØ Acciones de Demo</h2><div class="demo-controls"><button onclick='simulateChange("cupos")'>üî¢ Cambiar Cupos<br><small style="opacity:.8">Simula actualizaci√≥n de disponibilidad</small></button> <button onclick='simulateChange("fecha")'>üìÖ Cambiar Fecha<br><small style="opacity:.8">Simula reprogramaci√≥n de evento</small></button> <button onclick='simulateChange("nuevo")'>‚ûï Agregar Evento<br><small style="opacity:.8">Simula nuevo evento agregado</small></button> <button onclick='simulateChange("eliminar")'>‚ùå Eliminar Evento<br><small style="opacity:.8">Simula evento cancelado</small></button> <button onclick="forceRefresh()" style="background:rgba(16,185,129,.8)">üîÑ Forzar Actualizaci√≥n<br><small style="opacity:.8">Consultar ahora sin esperar</small></button></div><div class="instructions"><strong>üí° C√≥mo funciona:</strong><ul style="margin:10px 0;padding-left:20px"><li>Hac√© click en cualquier bot√≥n de acci√≥n</li><li>Se simula un cambio en Google Sheets</li><li>El sistema detecta el cambio autom√°ticamente</li><li>La lista se actualiza sin recargar</li></ul><p style="margin:10px 0 0 0"><strong>Nota:</strong> Esta es una simulaci√≥n local. En producci√≥n, los cambios vienen de Google Sheets.</p></div></div><div class="panel"><h2>üìä Estado del Sistema</h2><div id="status"></div><div style="text-align:center;margin:20px 0"><div style="font-size:.9em;opacity:.8">Pr√≥xima consulta en:</div><div class="timer" id="timer">30</div><div style="font-size:.9em;opacity:.8">segundos</div></div><h3 style="margin:20px 0 10px 0">üìÖ Eventos Actuales (<span id="count">0</span>)</h3><div id="eventos" class="eventos-list"></div></div></div><script src="./js/agenda-loader.js"></script><script>let timerInterval,simulatedEventos=[],nextRefresh=30;function updateStatus(t,e){document.getElementById("status").innerHTML=`<div class="status ${e}">${t}</div>`}function renderEventos(t,e=!1){const n=document.getElementById("eventos"),o=document.getElementById("count");if(!t||0===t.length)return n.innerHTML='<div style="opacity: 0.6; text-align: center; padding: 20px;">No hay eventos</div>',void(o.textContent="0");o.textContent=t.length,n.innerHTML=t.map((t,n)=>`\n        <div class="evento-card ${e?"updated":""}" style="animation-delay: ${.1*n}s">\n          <div style="font-size: 0.85em; opacity: 0.8; margin-bottom: 5px;">\n            ${t.f||"Sin fecha"}\n          </div>\n          <div style="font-size: 1.1em; font-weight: 600; margin-bottom: 5px;">\n            ${t.t||"Sin t√≠tulo"}\n          </div>\n          <div style="font-size: 0.9em; opacity: 0.9; color: #fbbf24;">\n            ${t.cupos||"Sin info"}\n          </div>\n        </div>\n      `).join("")}function simulateChange(t){const e={cupos:()=>{if(simulatedEventos.length>0){const t=Math.floor(Math.random()*simulatedEventos.length),e=simulatedEventos[t].cupos;simulatedEventos[t].cupos=`Quedan ${Math.floor(10*Math.random())+1}`,updateStatus(`‚úÖ Simulado: Cambio de cupos en "${simulatedEventos[t].t}"<br><small>Antes: ${e} ‚Üí Ahora: ${simulatedEventos[t].cupos}</small>`,"success")}},fecha:()=>{if(simulatedEventos.length>0){const t=Math.floor(Math.random()*simulatedEventos.length),e=["Lun","Mar","Mi√©","Jue","Vie","S√°b","Dom"],n=e[Math.floor(Math.random()*e.length)],o=Math.floor(28*Math.random())+1,a=`${Math.floor(12*Math.random())+10}:00`;simulatedEventos[t].f=`${n} ${o} Nov ¬∑ ${a}`,updateStatus(`‚úÖ Simulado: Cambio de fecha en "${simulatedEventos[t].t}"`,"success")}},nuevo:()=>{const t={f:`Vie ${Math.floor(28*Math.random())+1} Dic ¬∑ 19:00`,t:"Nuevo Evento de Tarot",cupos:"Abierta inscripci√≥n"};simulatedEventos.push(t),updateStatus(`‚úÖ Simulado: Nuevo evento agregado: "${t.t}"`,"success")},eliminar:()=>{if(simulatedEventos.length>1){updateStatus(`‚úÖ Simulado: Evento eliminado: "${simulatedEventos.pop().t}"`,"warning")}else updateStatus("‚ö†Ô∏è No se puede eliminar: debe quedar al menos 1 evento","warning")}};e[t]&&(e[t](),window.AGENDA_EVENTOS=[...simulatedEventos],window.dispatchEvent(new CustomEvent("agendaUpdated",{detail:simulatedEventos})),renderEventos(simulatedEventos,!0))}function forceRefresh(){updateStatus("üîÑ Forzando actualizaci√≥n...","info"),nextRefresh=30,setTimeout(()=>{updateStatus("‚úÖ Actualizaci√≥n completada","success"),renderEventos(simulatedEventos)},500)}function startTimer(){timerInterval=setInterval(()=>{nextRefresh--,document.getElementById("timer").textContent=nextRefresh,nextRefresh<=0&&(nextRefresh=30,updateStatus("üîÑ Consultando Google Sheets...","info"),setTimeout(()=>{updateStatus("‚úÖ Sistema sincronizado","success")},1e3))},1e3)}setTimeout(()=>{window.AGENDA_EVENTOS&&window.AGENDA_EVENTOS.length?(simulatedEventos=[...window.AGENDA_EVENTOS],updateStatus("‚úÖ Sistema iniciado correctamente","success"),renderEventos(simulatedEventos)):(simulatedEventos=[{f:"S√°b 16 Nov ¬∑ 18:00",t:"Vinito y Tarot (Microcentro)",cupos:"Quedan 7"},{f:"Vie 29 Nov ¬∑ 19:00",t:"Vinito y Tarot a domicilio",cupos:"Cupos 10‚Äì30"},{f:"S√°b 14 Dic ¬∑ 10:00",t:"Formaci√≥n Tarot ‚Äì M√≥dulo 1",cupos:"Abierta inscripci√≥n"}],window.AGENDA_EVENTOS=simulatedEventos,updateStatus("‚úÖ Sistema iniciado con datos de ejemplo","info"),renderEventos(simulatedEventos)),startTimer()},500),window.addEventListener("agendaUpdated",t=>{console.log("üéâ Evento agendaUpdated detectado:",t.detail)})</script></body></html>