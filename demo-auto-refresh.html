<!DOCTYPE html><html lang="es"><head><meta charset="UTF-8"><title>Demo Auto-Refresh - Ser Magia</title><style>*{box-sizing:border-box}body{font-family:system-ui,-apple-system,sans-serif;max-width:900px;margin:0 auto;padding:20px;background:linear-gradient(135deg,#667eea 0,#764ba2 100%);color:#fff}h1{color:#fff;text-shadow:0 2px 10px rgba(0,0,0,.3)}.card{background:rgba(255,255,255,.15);backdrop-filter:blur(10px);border-radius:16px;padding:20px;margin:20px 0;box-shadow:0 8px 32px rgba(0,0,0,.2);border:1px solid rgba(255,255,255,.2)}.status{padding:12px 16px;border-radius:8px;margin:10px 0;font-weight:600;display:flex;align-items:center;gap:10px}.success{background:rgba(16,185,129,.3);border-left:4px solid #10b981}.info{background:rgba(59,130,246,.3);border-left:4px solid #3b82f6}.warning{background:rgba(245,158,11,.3);border-left:4px solid #f59e0b}.error{background:rgba(239,68,68,.3);border-left:4px solid #ef4444}.eventos-grid{display:grid;gap:15px;margin-top:20px}.evento-item{background:rgba(255,255,255,.1);padding:15px;border-radius:12px;border:1px solid rgba(255,255,255,.2);transition:all .3s ease}.evento-item:hover{background:rgba(255,255,255,.2);transform:translateY(-2px)}.evento-item.new{animation:slideIn .5s ease;border-left:4px solid #10b981}@keyframes slideIn{from{opacity:0;transform:translateX(-20px)}to{opacity:1;transform:translateX(0)}}.timer{display:inline-block;font-family:'Courier New',monospace;font-size:1.5em;font-weight:700;color:#fbbf24;text-shadow:0 2px 4px rgba(0,0,0,.3)}.pulse{animation:pulse 2s ease-in-out infinite}@keyframes pulse{0%,100%{opacity:1}50%{opacity:.5}}button{background:rgba(139,92,246,.8);color:#fff;border:none;padding:12px 24px;border-radius:8px;cursor:pointer;font-weight:600;transition:all .3s;margin:5px}button:hover{background:#8b5cf6;transform:translateY(-2px);box-shadow:0 4px 12px rgba(139,92,246,.5)}.log{background:rgba(0,0,0,.3);padding:15px;border-radius:8px;max-height:300px;overflow-y:auto;font-family:'Courier New',monospace;font-size:.85em}.log-entry{padding:5px 0;border-bottom:1px solid rgba(255,255,255,.1)}.log-entry:last-child{border-bottom:none}</style></head><body><h1>üîÑ Demo: Auto-Refresh de Agenda</h1><div class="card"><h2>‚è±Ô∏è Pr√≥xima actualizaci√≥n en: <span class="timer pulse" id="timer">30</span> segundos</h2><p>El sistema consulta Google Sheets autom√°ticamente cada 30 segundos</p></div><div class="card"><h2>üìä Estado Actual</h2><div id="status"></div><div><button onclick="forceRefresh()">üîÑ Forzar Actualizaci√≥n Ahora</button> <button onclick="clearLogs()">üóëÔ∏è Limpiar Logs</button> <button onclick='location.href="/"'>üè† Volver al Sitio</button></div></div><div class="card"><h2>üìÖ Eventos Cargados (<span id="count">0</span>)</h2><div id="eventos" class="eventos-grid"></div></div><div class="card"><h2>üìù Log de Actividad</h2><div id="log" class="log"></div></div><div class="card"><h2>üí° Instrucciones</h2><ol><li><strong>Abr√≠ tu Google Sheet</strong> en otra pesta√±a</li><li><strong>Edit√° un evento</strong> (cambiar fecha, t√≠tulo, o cupos)</li><li><strong>Esper√° 30-60 segundos</strong> y observ√° esta p√°gina</li><li>Deber√≠as ver el cambio <strong>autom√°ticamente</strong> sin recargar</li></ol><p><strong>Tip:</strong> Abr√≠ la consola del navegador (F12) para ver m√°s detalles</p></div><script src="./js/agenda-loader.js"></script><script>let refreshInterval,timerInterval,lastEventosJson="",nextRefresh=30;function addLog(e,t="info"){const n=document.getElementById("log"),o=document.createElement("div");o.className="log-entry";const s=(new Date).toLocaleTimeString(),a="success"===t?"‚úÖ":"error"===t?"‚ùå":"‚ÑπÔ∏è";for(o.innerHTML=`<span style="color: #94a3b8">[${s}]</span> ${a} ${e}`,n.insertBefore(o,n.firstChild);n.children.length>20;)n.removeChild(n.lastChild)}function updateStatus(e,t){document.getElementById("status").innerHTML=`<div class="status ${t}">${e}</div>`}function renderEventos(e){const t=document.getElementById("eventos"),n=document.getElementById("count");if(!e||0===e.length)return t.innerHTML='<p style="opacity: 0.6">No hay eventos cargados</p>',void(n.textContent="0");n.textContent=e.length;const o=JSON.stringify(e),s=o!==lastEventosJson;lastEventosJson=o,t.innerHTML=e.map(e=>`\n        <div class="evento-item ${s?"new":""}">\n          <div style="display: flex; justify-content: space-between; align-items: start;">\n            <div>\n              <div style="font-size: 0.85em; opacity: 0.8; margin-bottom: 5px;">${e.f||"Sin fecha"}</div>\n              <div style="font-size: 1.1em; font-weight: 600; margin-bottom: 5px;">${e.t||"Sin t√≠tulo"}</div>\n              <div style="font-size: 0.9em; opacity: 0.9;">${e.cupos||"Sin info de cupos"}</div>\n            </div>\n            ${s?'<div style="color: #10b981; font-weight: bold;">NUEVO</div>':""}\n          </div>\n        </div>\n      `).join("")}function checkForUpdates(){if(addLog("Consultando Google Sheets...","info"),updateStatus("‚è≥ Consultando Google Sheets...","info"),window.AGENDA_EVENTOS&&window.AGENDA_EVENTOS.length){const e=window.AGENDA_EVENTOS;updateStatus(`‚úÖ √öltima actualizaci√≥n: ${(new Date).toLocaleTimeString()} - ${e.length} evento(s)`,"success"),addLog(`Eventos encontrados: ${e.length}`,"success"),renderEventos(e)}else updateStatus("‚ö†Ô∏è Esperando datos...","warning"),addLog("A√∫n no hay datos disponibles","info");nextRefresh=30}function forceRefresh(){addLog("üîÑ Actualizaci√≥n forzada por el usuario","info"),nextRefresh=0,checkForUpdates()}function clearLogs(){document.getElementById("log").innerHTML="",addLog("Logs limpiados","info")}function startTimer(){timerInterval=setInterval(()=>{nextRefresh--,document.getElementById("timer").textContent=nextRefresh,nextRefresh<=0&&(nextRefresh=30,checkForUpdates())},1e3)}window.addEventListener("agendaUpdated",e=>{const t=e.detail;addLog(`üéâ ¬°Agenda actualizada autom√°ticamente! (${t.length} eventos)`,"success"),updateStatus(`‚úÖ Actualizaci√≥n autom√°tica detectada - ${t.length} evento(s)`,"success"),renderEventos(t)}),addLog("Demo iniciada. Esperando datos...","info"),updateStatus("üöÄ Iniciando...","info"),setTimeout(()=>{window.AGENDA_LOADER_PROMISE?(addLog("Sistema de auto-refresh detectado ‚úÖ","success"),window.AGENDA_LOADER_PROMISE.then(()=>{checkForUpdates()})):(addLog("‚ö†Ô∏è Sistema de auto-refresh no disponible","error"),updateStatus("‚ùå Error: agenda-loader.js no se carg√≥ correctamente","error")),startTimer()},500)</script></body></html>