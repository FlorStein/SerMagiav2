<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Ser Magia · Tarot</title>
    <meta name="description" content="Acompañamiento amoroso con Tarot, Akasha y sanación." />
    
    <!-- Preconnect para optimizar carga de recursos externos -->
    <link rel="preconnect" href="https://cdn.tailwindcss.com">
    <link rel="preconnect" href="https://unpkg.com">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Merienda:wght@300..900&display=swap" rel="stylesheet">
    
    <!-- Preload critical scripts para reducir render blocking -->
    <link rel="preload" href="https://unpkg.com/react@18/umd/react.production.min.js" as="script" crossorigin>
    <link rel="preload" href="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" as="script" crossorigin>
    <link rel="preload" href="./app.js" as="script">
    
    <!-- Preload imagen LCP para descubrimiento inmediato -->
    <link rel="preload" href="./assets/background-tarot.webp" as="image" fetchpriority="high">
    <link rel="preload" href="./assets/cartas1122.png" as="image" fetchpriority="high">
    
    <!-- Preload de fuentes críticas con display=swap para evitar layout shift -->
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=New+Rocker&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Playfair+Display:wght@400;600;700&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
    
    <!-- Fallback para fuentes si JS está deshabilitado -->
    <noscript>
      <link href="https://fonts.googleapis.com/css2?family=New+Rocker&display=swap" rel="stylesheet">
      <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Playfair+Display:wght@400;600;700&display=swap" rel="stylesheet">
    </noscript>
    
    <style>
      html, body { scroll-behavior: smooth; width:100%; overflow-x:hidden; }
      img, video { max-width: 100%; height: auto; }
      .font-serif { font-family: 'Playfair Display', serif; }
      .font-sans { font-family: 'Inter', system-ui, -apple-system, Segoe UI, Roboto, sans-serif; }
      /* keyframes: riseFade & glowTitle */
      @keyframes riseFade { from { opacity:0; transform: translateY(12px);} to { opacity:1; transform: translateY(0);} }
      @keyframes glowTitle { 0% { text-shadow: none; } 100% { text-shadow: 0 0 20px rgba(242,139,102,.35);} }

      /* Clase existente para texto con New Rocker */
      .new-rocker-regular {
        font-family: "Merienda", system-ui, cursive;
        font-weight: 700;
        font-style: normal;
      }

      /* Aplicar Merienda a todos los títulos por defecto */
      h1, h2, h3, h4, h5, h6 {
        font-family: "Merienda", system-ui, cursive;
        font-weight: 700;
        margin: 0;
      }

      /* Blanco + brillo violeta para títulos */
      .title-white { color:#fff !important; }
      .glow-violet { text-shadow: 0 0 18px rgba(89, 50, 181, 0.8), 0 0 8px rgba(138, 11, 210, 0.6); }

    
      /* Fade-in para elementos al entrar en viewport */
      .reveal { opacity: 0; transform: translateY(16px); transition: opacity .6s ease, transform .6s ease; }
      .reveal.in { opacity: 1; transform: none; }

  /* Efecto aura con colores lilas, violetas y amarillos */
  .aura-effect {
    position: relative;
    animation: auraGlow 4s ease-in-out infinite;
  }
  
  @keyframes auraGlow {
    0%, 100% {
      box-shadow: 
        0 0 20px rgba(138, 11, 210, 0.4),
        0 0 40px rgba(138, 11, 210, 0.3),
        0 0 60px rgba(138, 11, 210, 0.2),
        0 0 80px rgba(217, 128, 249, 0.1);
    }
    25% {
      box-shadow: 
        0 0 25px rgba(217, 128, 249, 0.5),
        0 0 50px rgba(217, 128, 249, 0.4),
        0 0 75px rgba(138, 11, 210, 0.3),
        0 0 100px rgba(255, 215, 0, 0.2);
    }
    50% {
      box-shadow: 
        0 0 30px rgba(255, 215, 0, 0.4),
        0 0 60px rgba(217, 128, 249, 0.4),
        0 0 90px rgba(138, 11, 210, 0.3),
        0 0 120px rgba(217, 128, 249, 0.2);
    }
    75% {
      box-shadow: 
        0 0 25px rgba(138, 11, 210, 0.5),
        0 0 50px rgba(255, 215, 0, 0.3),
        0 0 75px rgba(217, 128, 249, 0.3),
        0 0 100px rgba(138, 11, 210, 0.2);
    }
  }

  /* Navbar: color blanco por defecto para enlaces */
  .site-header a { color: #fff; }
  .site-header a:hover { color: #d980f9; }

  /* Navbar: glassmorfismo violeta cuando #servicios está visible */
  /* Restaurar fondo púrpura translúcido con blur y forzar texto blanco */
  body.services-in .site-header {
    background: rgba(90,50,181,0.18) !important; /* violeta translúcido similar a bg-[#5A32B5]/20 */
    backdrop-filter: blur(14px);
    -webkit-backdrop-filter: blur(14px);
    border-bottom: 1px solid rgba(90,50,181,0.18);
    box-shadow: 0 6px 30px rgba(90,50,181,0.06);
  }
  /* Forzar color blanco para títulos/enlaces dentro del header cuando se activa services-in */
  body.services-in .site-header .title-white,
  body.services-in .site-header a,
  body.services-in .site-header .text-white { color: #fff !important; }
  /* Mantener botones visibles (background púrpura con texto blanco) */
  body.services-in .site-header a.rounded-full,
  body.services-in .site-header a[href*="wa.link"] { color: #fff !important; }
  
  /* Efecto hover especial para el botón Espiar (solo en sección vinito) */
  #vinito a[href="galeria-vinito.html"] {
    position: relative;
    transition: all 0.3s ease;
  }
  
  #vinito a[href="galeria-vinito.html"]:hover {
    background: linear-gradient(135deg, #d980f9 0%, #f2bb66 100%) !important;
    color: #1a0b2e !important;
    box-shadow: 
      0 0 20px rgba(217, 128, 249, 0.6),
      0 0 40px rgba(242, 187, 102, 0.4),
      0 4px 15px rgba(0, 0, 0, 0.3);
    transform: translateY(-2px) scale(1.05);
    border-color: transparent !important;
  }
  
  #vinito a[href="galeria-vinito.html"]:active {
    transform: translateY(0) scale(1.02);
  }
  
  /* Efecto hover brillante para el botón Próximo vinito (solo en sección vinito) */
  #vinito a[href="https://wa.me/5491168040649"] {
    position: relative;
    transition: all 0.3s ease;
    overflow: hidden;
  }
  
  #vinito a[href="https://wa.me/5491168040649"]::before {
    content: '';
    position: absolute;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: linear-gradient(
      45deg,
      transparent 30%,
      rgba(255, 255, 255, 0.3) 50%,
      transparent 70%
    );
    transform: rotate(45deg) translateX(-100%);
    transition: transform 0.6s ease;
  }
  
  #vinito a[href="https://wa.me/5491168040649"]:hover {
    background: linear-gradient(135deg, #f28b66 0%, #d980f9 100%) !important;
    box-shadow: 
      0 0 25px rgba(242, 139, 102, 0.7),
      0 0 50px rgba(217, 128, 249, 0.5),
      0 8px 20px rgba(0, 0, 0, 0.3);
    transform: translateY(-3px) scale(1.08);
  }
  
  #vinito a[href="https://wa.me/5491168040649"]:hover::before {
    transform: rotate(45deg) translateX(100%);
  }
  
  #vinito a[href="https://wa.me/5491168040649"]:active {
    transform: translateY(-1px) scale(1.05);
  }
  
  /* Efecto hover brillante para el botón Tu Vinito & Tarot (solo en sección vinito) */
  #vinito a[href="#contacto"] {
    position: relative;
    transition: all 0.3s ease;
    overflow: hidden;
    background: rgba(217, 128, 249, 0.15) !important;
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
  }
  
  @media (max-width: 768px) {
    #vinito a[href="#contacto"] {
      background: rgba(0, 0, 0, 0.5) !important;
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
    }
  }
  
  #vinito a[href="#contacto"]::before {
    content: '';
    position: absolute;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: linear-gradient(
      45deg,
      transparent 30%,
      rgba(255, 255, 255, 0.3) 50%,
      transparent 70%
    );
    transform: rotate(45deg) translateX(-100%);
    transition: transform 0.6s ease;
  }
  
  #vinito a[href="#contacto"]:hover {
    background: linear-gradient(135deg, #f28b66 0%, #d980f9 100%) !important;
    box-shadow: 
      0 0 25px rgba(242, 139, 102, 0.7),
      0 0 50px rgba(217, 128, 249, 0.5),
      0 8px 20px rgba(0, 0, 0, 0.3);
    transform: translateY(-3px) scale(1.08);
  }
  
  #vinito a[href="#contacto"]:hover::before {
    transform: rotate(45deg) translateX(100%);
  }
  
  #vinito a[href="#contacto"]:active {
    transform: translateY(-1px) scale(1.05);
  }

  /* Efecto vinito reutilizable (para botones fuera de la sección) */
  .btn-vinito {
    position: relative;
    transition: all 0.3s ease;
    overflow: hidden;
    background: #8a0bd2 !important; /* color base anterior */
    color: #fff !important;
    border: none;
  }
  .btn-vinito::before {
    content: '';
    position: absolute;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: linear-gradient(
      45deg,
      transparent 30%,
      rgba(255, 255, 255, 0.3) 50%,
      transparent 70%
    );
    transform: rotate(45deg) translateX(-100%);
    transition: transform 0.6s ease;
  }
  .btn-vinito:hover {
    background: linear-gradient(135deg, #f28b66 0%, #d980f9 100%) !important;
    box-shadow: 
      0 0 25px rgba(242, 139, 102, 0.7),
      0 0 50px rgba(217, 128, 249, 0.5),
      0 8px 20px rgba(0, 0, 0, 0.3);
    transform: translateY(-3px) scale(1.08);
  }
  .btn-vinito:hover::before {
    transform: rotate(45deg) translateX(100%);
  }
  .btn-vinito:active {
    transform: translateY(-1px) scale(1.05);
  }
  
  /* Estilo para link de Studio Nola Atelier en footer */
  .studio-nola-link:hover {
    color: #fff !important;
    text-shadow: 0 0 15px rgba(244, 219, 255, 0.8), 0 0 25px rgba(217, 128, 249, 0.6);
    transform: scale(1.05);
  }

  /* Override: ajustar transparencia del utilitario Tailwind bg-white/80 */
  .bg-white\/80 {
    background-color: rgb(255 255 255 / 7%) !important;
  }

  /* Fondo fijo estable */
  .bg-sticky-stable {
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    background-attachment: fixed;
  }

  @media (max-width: 768px) {
    .bg-sticky-stable { background-attachment: scroll; }
  }

  /* Background más pequeño en mobile para mostrar más detalle del estampado */
  @media (max-width: 768px) {
    .bg-smaller {
      background-size: calc(140% + 10px) !important; /* ligera solapa para tapar bordes */
      background-position: center center !important;
      background-repeat: no-repeat !important;
      background-origin: border-box;
    }
    /* Variante repetida con solapado de 10px (para hero y servicios) */
    .bg-repeat-10 {
      background-size: calc(140% + 10px) !important;
      background-position: center center !important;
      background-repeat: repeat !important;
      background-origin: border-box;
    }
  }

  /* Ajuste de solapa para el pseudo de flip */
  @media (max-width: 768px) {
    .bg-flip-mobile::before {
      background-size: calc(140% + 10px);
      background-repeat: no-repeat;
      background-position: center calc(50% - 10px);
      background-origin: border-box;
    }
  }

  /* Flip de fondo solo en mobile (ej. contacto) */
  .bg-flip-mobile { position: relative; }
  .bg-flip-mobile::before { content: ""; position: absolute; inset: 0; pointer-events: none; display: none; }
  @media (max-width: 768px) {
    .bg-flip-mobile { background: none !important; overflow: hidden; }
    .bg-flip-mobile::before {
      display: block;
      background-image: var(--bg-img);
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      transform: scaleY(-1);
    }
    .bg-flip-mobile > * { position: relative; }
  }

  /* Hover destacado para botones (aplicar con clase btn-boost) */
  .btn-boost {
    position: relative;
    transition: transform 0.2s ease, box-shadow 0.2s ease, background 0.2s ease, color 0.2s ease, border-color 0.2s ease;
    color: #111 !important;
  }
  .btn-boost:hover {
    transform: translateY(-2px);
    background: linear-gradient(135deg, #d980f9 0%, #4d6bff 100%) !important;
    color: #111 !important;
    border-color: transparent !important;
    box-shadow: 0 10px 30px rgba(217, 128, 249, 0.28), 0 6px 18px rgba(0,0,0,0.18);
  }
  .btn-boost:active {
    transform: translateY(-1px);
    background: linear-gradient(135deg, #c46de6 0%, #3d5adf 100%) !important;
    color: #111 !important;
    border-color: transparent !important;
    box-shadow: 0 6px 18px rgba(217, 128, 249, 0.22), 0 3px 10px rgba(0,0,0,0.14);
  }

  /* Override para texto blanco en botones específicos */
  .btn-boost.text-white,
  .btn-boost.text-white:hover,
  .btn-boost.text-white:active {
    color: #fff !important;
  }
    
    </style>
  </head>
  <body class="font-sans bg-[#FFF4EA] text-[#2B1E1A] selection:bg-[#F6C6CF] selection:text-[#2B1E1A]">
    <div id="root"></div>
    <script>
      // Endpoint real de Formspree
      window.FORMSPREE_ENDPOINT = "https://formspree.io/f/mlgrpqdk";
    </script>
    
    <!-- React y dependencias con defer para no bloquear render inicial -->
    <script defer crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script defer crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Tailwind CDN - Para producción considera usar Tailwind CLI -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- App compilado (sin Babel en el navegador) -->
    <script defer src="./js/agenda-loader.js"></script>
    <script defer src="./app.js"></script>
  
  <!-- Scripts de animación y efectos -->
  <script>
    window.addEventListener('load', function() {
      // Fade-in for services cards
      var cards = [].slice.call(document.querySelectorAll('#servicios .reveal'));
      if ('IntersectionObserver' in window) {
        var io = new IntersectionObserver(function(entries){
          entries.forEach(function(e){ if (e.isIntersecting) e.target.classList.add('in'); });
        }, { rootMargin: '0px 0px -10% 0px', threshold: 0.1 });
        cards.forEach(function(el){ io.observe(el); });
      } else {
        cards.forEach(function(el){ el.classList.add('in'); });
      }

      // Toggle body.services-in when the servicios section is in view
      var servicios = document.querySelector('#servicios');
      if (servicios && 'IntersectionObserver' in window) {
        var io2 = new IntersectionObserver(function(entries){
          entries.forEach(function(e){
            if (e.isIntersecting) { document.body.classList.add('services-in'); }
            else { document.body.classList.remove('services-in'); }
          });
        }, { rootMargin: '0px', threshold: 0.2 });
        io2.observe(servicios);
      }

      function activateServicesFade(){
        var cards = [].slice.call(document.querySelectorAll('#servicios .reveal'));
        cards.forEach(function(el){ el.classList.add('in'); });
        document.body.classList.add('services-in');
      }

      // On scroll into view (keeps existing IntersectionObserver behavior if present)
      if (!window.__servIO) {
        var servicios = document.querySelector('#servicios');
        if (servicios && 'IntersectionObserver' in window) {
          window.__servIO = new IntersectionObserver(function(entries){
            entries.forEach(function(e){
              if (e.isIntersecting) activateServicesFade();
            });
          }, { rootMargin: '0px', threshold: 0.2 });
          window.__servIO.observe(servicios);
        }
      }

      // On nav click to #servicios
      var navLinks = [].slice.call(document.querySelectorAll('a[href="#servicios"]'));
      navLinks.forEach(function(a){
        a.addEventListener('click', function(){
          setTimeout(activateServicesFade, 300);
        });
      });

      // On hash navigation
      window.addEventListener('hashchange', function(){
        if (location.hash === '#servicios') setTimeout(activateServicesFade, 100);
      });

      // If page loads directly at #servicios
      if (location.hash === '#servicios') setTimeout(activateServicesFade, 200);
    });
    
    // ========== LAZY LOADING (fuera del load event) ==========
    // Ejecutar después de que React monte los elementos
    function setupLazyLoading() {
      // Lazy load background images
      var lazyBgSections = [].slice.call(document.querySelectorAll('.lazy-bg'));
      
      if (lazyBgSections.length === 0) {
        // React aún no montó, intentar de nuevo
        setTimeout(setupLazyLoading, 200);
        return;
      }
      
      if ('IntersectionObserver' in window) {
        var bgObserver = new IntersectionObserver(function(entries) {
          entries.forEach(function(entry) {
            if (entry.isIntersecting) {
              var section = entry.target;
              var bgUrl = section.getAttribute('data-bg');
              if (bgUrl) {
                section.style.backgroundImage = 'url(' + bgUrl + ')';
                section.classList.remove('lazy-bg');
              }
              bgObserver.unobserve(section);
            }
          });
        }, { rootMargin: '200px 0px' });
        
        lazyBgSections.forEach(function(section) {
          bgObserver.observe(section);
        });
      } else {
        // Fallback: load all backgrounds immediately
        lazyBgSections.forEach(function(section) {
          var bgUrl = section.getAttribute('data-bg');
          if (bgUrl) section.style.backgroundImage = 'url(' + bgUrl + ')';
        });
      }
      
      // Lazy load videos
      var lazyVideos = [].slice.call(document.querySelectorAll('.lazy-video'));
      if ('IntersectionObserver' in window && lazyVideos.length > 0) {
        var videoObserver = new IntersectionObserver(function(entries) {
          entries.forEach(function(entry) {
            if (entry.isIntersecting) {
              var video = entry.target;
              var src = video.getAttribute('data-src');
              if (src) {
                video.src = src;
                video.load();
                video.play().catch(function(){}); // autoplay if allowed
                video.classList.remove('lazy-video');
              }
              videoObserver.unobserve(video);
            }
          });
        }, { rootMargin: '100px 0px' });
        
        lazyVideos.forEach(function(video) {
          videoObserver.observe(video);
        });
      } else if (lazyVideos.length > 0) {
        // Fallback: load all videos immediately
        lazyVideos.forEach(function(video) {
          var src = video.getAttribute('data-src');
          if (src) {
            video.src = src;
            video.load();
          }
        });
      }
    }
    
    // Ejecutar cuando el DOM esté listo y después de un pequeño delay
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', function() {
        setTimeout(setupLazyLoading, 300);
      });
    } else {
      setTimeout(setupLazyLoading, 300);
    }
  </script>
</body>
</html>
